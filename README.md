# TDP 43 Phase Separation

## Table Of Contents
1. [Introduction](#introduction)
2. [Simulation Code/Data Navigation](#simulation-codedata-navigation)
3. [Analysis Code/Data Navigation](#analysis-codedata-navigation)

## Introduction

Hello and welcome to the github repository for the paper [] by Haider, Shipley, et al. This repository will house a complete collection of all of the code used to generate computational data and results for the paper. Note, however, that this repository will only contain representative inputs and outputs. For access to the complete dataset, please navigate to our osf repository here[], which contains none of the code, but all of the inputs and outputs for this project. 

The aim of this project was to explore the biphasic nature of TDP-43 LCD phosphomimetic variant phase separation diagrams relative to the non-biphasic TDP-43 LCD WT phase separation diagram. To probe the types of interactions that drive this behavior, a coarse grained simulation framework was developed to simulate these TDP-43 systems. These simulations are the concern of this repository, and the code can largely be broken into two chunks. The first set of code/data is classified as [Simulation](/Simulation/), which is concerned with generating, running, and extracting results of simulation. The second set of code/data is classified as [Analysis](/Analysis/), which is concerned with analyzing the results of the simulations. All code for this project was generated in Python using .ipynb Jupyter notebooks. 

The most recent stable versions of libraries/packages which can be used to run all of the following code are:




But stable versions of libraries and packages which can be used to successfully run bits of code will be listed individually for each chunk of code. 

## Simulation Code/Data Navigation

When you enter the [Simulation](/Simulation/) directory, you will notice many sub-directories. These sub-directories will each contain three items, an input directory, an output directory, and a .ipynb notebook. 

* [Extract Protein AA Chain](/Simulation/Extract_Protein_AA_Chain/)
  This first sub-directory contains a helper code which can convert the amino acid chain which comprises a protein to the correct format for use in the simulation code. Specifically, this code will convert a .txt file of the amino acid chain into a .csv format, where the chain is placed along one column, and each row represents a sequential amino acid in the chain.

  - Input: A .txt file containing the amino acid chain.
 
  - Output: A .csv file, which splits the amino acid chain along one column, and each row represents the next amino acid in the sequence.
 
  This code was last run without error with the following library versions:

  

* [TDP 43 LCD Simulation Base](/Analysis/TDP_43_LCD_Simulation_Base/)
  This sub-directory contains code which can be used as a base for running simulations of TDP-43-LCD wild type and it phosphomimimeic variants. The input for this code is a TDP-43 protein chain .csv file, and a .csv file containing the coarse grained parameters of the amino acids.

  - Input:
    A .csv file, containing the amino acid chain which comprises the protein we are interested in simulating, as well as a .csv file which contains all of the coarse-grained properties of the amino acids.

  - Output:
    The output is five .gsd files, where a .gsd file contains the positions and name of each amino acid in the simulaion box. The naming convention for the .gsd files is as follows. Each .gsd file will fully describe the system in question, and has the following template:

    [Protein Concentration]_uM_Protein_[Salt Concentration]_mM_Salt_[Phosphorylation]_phos_[Lennard-Jones Potential Epsilon]_Epsilon_[Ending].gsd Where the possible endings are:
  
    single_Protein - This .gsd file is the first step in preparation, and constitutes a single protein floating in a simulation box.

    cloned_Proteins - This .gsd file is the second step in preparation, and constitutes the original protein, cloned a number of times to match the desired protein concentration.

    compressed_System - This .gsd file is the third step in preparation, and constitues the system of cloned proteins after being squished together into a simulation cube. This step ensures that the proteins are in a semi-phase-separated state at the beginning of the      production steps.

    compressed_Extended_Box - This .gsd file is the fourth step in preparation, and consitutes the system of cloned proteins in a slab, where the slab was generated by extending the z-component of the cube that the proteins were squished into in the previous           
    preparation step.

    Trajectory - This .gsd file is the production of the protein simulation in the box. This file contains the position and identifier for each amino acid sitting in the box for all time steps of the simulation.
  
  This code was last run without errors with the following library versions:

* [TDP 43 LCD 5x_Protein_Simulation Base](/Analysis/TDP_43_LCD_5x_Protein_Simulation_Base/)
  This sub-directory contains code which can be used as a base for running simulations of TDP-43-LCD wild type and its phosphomimetic variants with 5x the number of proteins used in the paper main-text results. The input for this code is a TDP-43 protein chain .csv file, and a .csv file containing the coarse grained parameters of the amino acids. This code was used to show that our choice of using an intentionally small number of proteins was justifiable, insofar as using a larger number of proteins would not qualitatively change the results of the simulations.

  - Input:
    A .csv file, containing the amino acid chain which comprises the protein we are interested in simulating, as well as a .csv file which contains all of the coarse-grained properties of the amino acids.

  - Output:
    The output is five .gsd files, where a .gsd file contains the positions and name of each amino acid in the simulaion box. The naming convention for the .gsd files is as follows. Each .gsd file will fully describe the system in question, and has the following template:

    5x_Protein_[Protein Concentration]_uM_Protein_[Salt Concentration]_mM_Salt_[Phosphorylation]_phos_[Lennard-Jones Potential Epsilon]_Epsilon_[Ending].gsd Where the possible endings are:

    single_Protein - This .gsd file is the first step in preparation, and constitutes a single protein floating in a simulation box.

    cloned_Proteins - This .gsd file is the second step in preparation, and constitutes the original protein, cloned a number of times to match the desired protein concentration.

    compressed_System - This .gsd file is the third step in preparation, and constitues the system of cloned proteins after being squished together into a simulation cube. This step ensures that the proteins are in a semi-phase-separated state at the beginning of the production steps.

    compressed_Extended_Box - This .gsd file is the fourth step in preparation, and consitutes the system of cloned proteins in a slab, where the slab was generated by extending the z-component of the cube that the proteins were squished into in the previous           
    preparation step.

    Trajectory - This .gsd file is the production of the protein simulation in the box. This file contains the position and identifier for each amino acid sitting in the box for all time steps of the simulation.

  This code was last run without errors with the following library versions:

* [TDP 43 LCD 5x_Protein Simulation Continuation](/Analysis/TDP_43_LCD_5x_Protein_Simulation_Continuation/)

  - Input:
   A .csv file, which contains all of the coarse-grained properties of the amino acids, as well as a .gsd file, containing the partially completed simulation. The output from the [TDP 43 LCD 5x_Protein_Simulation Base](/Analysis/TDP_43_LCD_5x_Protein_Simulation_Base/) section will suffice as an input for this code.

  - Output:
    The output is a single .gsd file, containing the position and identifier for each amino acid sitting in the simulation box for all time steps of the input simulation, as well as all additional timesteps completed from the continued simulation.
    

* [TDP 43 LCD Constant_Hydrophobics_Simulation Base](/Analysis/TDP_43_LCD_Constant_Hydrophobics_Simulation_Base/)
  This sub-directory contains code which can be used as a base for running simulations of TDP-43-LCD wild type and its phosphomimetic variants where the well depth of the Lennard-Jones potential was NOT changed as a function of salt concentration. The input for this code is a TDP-43 protein chain .csv file, and a .csv file containing the coarse grained parameters of the amino acids. This code was used to show that a salt dependant well-depth was necessary to generate phase separation diagrams that qualitatively match experimentally determined phase separation diagrams.

  - Input:
    A .csv file, containing the amino acid chain which comprises the protein we are interested in simulating, as well as a .csv file which contains all of the coarse-grained properties of the amino acids.

  - Output:
    The output is five .gsd files, where a .gsd file contains the positions and name of each amino acid in the simulaion box. The naming convention for the .gsd files is as follows. Each .gsd file will fully describe the system in question, and has the following template:

    Constant_Hydrophobics_[Protein Concentration]_uM_Protein_[Salt Concentration]_mM_Salt_[Phosphorylation]_phos_[Lennard-Jones Potential Epsilon]_Epsilon_[Ending].gsd Where the possible endings are:

    single_Protein - This .gsd file is the first step in preparation, and constitutes a single protein floating in a simulation box.

    cloned_Proteins - This .gsd file is the second step in preparation, and constitutes the original protein, cloned a number of times to match the desired protein concentration.

    compressed_System - This .gsd file is the third step in preparation, and constitues the system of cloned proteins after being squished together into a simulation cube. This step ensures that the proteins are in a semi-phase-separated state at the beginning of the production steps.

    compressed_Extended_Box - This .gsd file is the fourth step in preparation, and consitutes the system of cloned proteins in a slab, where the slab was generated by extending the z-component of the cube that the proteins were squished into in the previous           
    preparation step.

    Trajectory - This .gsd file is the production of the protein simulation in the box. This file contains the position and identifier for each amino acid sitting in the box for all time steps of the simulation. 

  This code was last run without errors with the following library versions:

## Analysis Code/Data Navigation

When you enter the [Analysis](/Analysis/) directory, you will notice many sub-directories. The goal here is to segment each distinct step in the analysis process into separate chunks of code/data to make the process accessible to an individual interested in recapitulating any part of the analysis. The code in this sub-directory are oriented towards extracting meaningful data from the simulations.
* [Extract AA Positions And Labels](/Analysis/Extract_AA_Positions_And_Labels/)
  The first step in analyzing our simulation results will be to extract the position and label of every amino acid (AA) from the simulation at every time step interval. The Hoomd-Blue toolkit reports the position and particle label of each amino acid in a .gsd file, which we would like to repurpose into numpy .npy array files, one for the positions of each amino acid, and one for the particle labels of each amino acid.

  - Input:
    A .gsd file, containing the positions and particle labels of each AA at all extracted timesteps of the simulation.

  - Output:
    Two .npy files, one containing the positions of each AA at all extracted timesteps of the simulation, and another containing labels of each AA in the simulation box at all extracted timesteps.

  This code was last run without errors with the following library versions:




* [Create Trajectory Gifs](/Analysis/Create_Trajectory_Gifs/)
  Once we have extracted all of the amino acid positions, we can then visualize how the system behaves over time. In this step, we convert all of the AA position data into a .gif. The .gif file shows the projection of each amino acid along one face of the simulation slab for each time step.

  - Input:
    A .npy file containing the positions of each AA for all extracted timesteps of the simulation.

  - Output:
    A .gif file, which shows the projection of each AA in the simulation box for all timesteps extracted from the simulation.

  This code was last run without errors with the following library versions:





* [Convert Trajectory Gifs To Video](/Analysis/Convert_Trajectory_Gifs_To_Video/)
  The code located in this sub-sub-drectory can be used to convert the previously generated trajectory .gif files into a trajectory .avi videos. The benefit of this process is that the time of the video can be panned through, allowing the user to look at particular timesteps in more detail.

  - Input:
    A .gif file, showing each AA in the simulation box projected onto one of the simulation slab faces at each time step in a simulation.
  - Output:
    A .avi video file, which is the exact same content as the input .gif, but which can now be panned through.

* [Extract AA TA_Pairwise Forces](/Analysis/Extract_AA_TA_Pairwise_Forces/)
  To complete our force analysis, we need to calculate the time averaged (TA) pairwise force (Electrostatic & Hydrophobic) for all pairs of AAs in the simulation box.

  - Input:
    The input for this code are two .npy files and one .csv file. One of the .npy files contains the positions of each AA in the simulation box for all timesteps, whereas the second .npy file contains the AA labels for each of the particles in the simulation box for all timesteps. Finally, the .csv file contains the coarse grained properties of each AA type.
    

  - Output:
    The output of the code are two .npy files. One contains the TA pairwise electrostatic forces, whereas the other contains the TA pairwise hydrophobic forces.

  This code was last run without errors with the following library versions:

* [Calculate Force_Sums](/Analysis/Calculate_Force_Sums/)
  Once we have extracted the TA electrostatic and hydrophobic forces, we now want to compare the relative magnitude of the sum of the electrostatic and hydrophobic forces. To calculate this quantity with an errorbar, we will use a block-bootstrapping procedure. These forces will allow us to comment on the relative importance of both forces in sustaining phase separation.
  - Input:
    The inputs for this code are two .npy files. One .npy file contains the TA pairwise electrostatic forces, whereas the other contains the TA pairwise hydrophobic forces.
    

  - Output:
    The outputs for this code are four .npy files. For both electrostatic forces and hydrophobic forces, the mean and standard deviation of the force sums are reported.

  This code was last run without errors with the following library versions:

* [Calculate Residue Forces](/Analysis/Calculate_Residue_Forces/)
  We can get a finer level of detail as far as how the TA inter-protein forces are distributed by disjointing the total force sums into components based upon locations of two interacting AAs in their respective proteins.
  - Input:
    The inputs for this code are two .npy files, one containing the TA electrostatic forces, and one containing the TA hydrophobic forces.

  - Output:
    The outputs of this code are two .npy files. One .npy file contains the residue-residue TA electrostatic forces, whereas the second contains the residue-residue TA hydrophobic forces.

  This code was last run without errors with the following library versions:

* [Plot Force_Sums](/Analysis/Plot_Force_Sums/)

  - Input:
    

  - Output:
    

  This code was last run without errors with the following library versions:

* [Plot Residue Forces](/Analysis/Plot_Residue_Forces/)

  - Input:
    

  - Output:
    

  This code was last run without errors with the following library versions:


